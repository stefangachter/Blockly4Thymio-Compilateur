$(function(){function e(){return $(".carte").length>=16||($(".carte").length>=1&&$("#bloc_carte").append('<i class="fa fa-plus bouton_plus"></i>'),!1)}function a(){return now=new Date,year=""+now.getFullYear(),month=""+(now.getMonth()+1),1==month.length&&(month="0"+month),day=""+now.getDate(),1==day.length&&(day="0"+day),hour=""+now.getHours(),1==hour.length&&(hour="0"+hour),minute=""+now.getMinutes(),1==minute.length&&(minute="0"+minute),second=""+now.getSeconds(),1==second.length&&(second="0"+second),year+month+day+hour+minute+second}$.backstretch("media/ciel.png");var l=0;localStorage.valeur_pas||(localStorage.valeur_pas=20),$("#champ_pas").val(localStorage.valeur_pas),localStorage.valeur_rotation||(localStorage.valeur_rotation=90),$("#champ_rotation").val(localStorage.valeur_rotation),localStorage.valeur_lumiere||(localStorage.valeur_lumiere=2),$("#champ_lumiere").val(localStorage.valeur_lumiere),$("#bouton_avancer").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-arrow-up carte_avancer"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-arrow-up carte_avancer"></i></div>')}),$("#bouton_reculer").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-arrow-down carte_reculer"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-arrow-down carte_reculer"></i></div>')}),$("#bouton_droite").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-repeat carte_droite"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-repeat carte_droite"></i></div>')}),$("#bouton_gauche").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-undo carte_gauche"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-undo carte_gauche"></i></div>')}),$("#bouton_rouge").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-circle carte_rouge"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-circle carte_rouge"></i></div>')}),$("#bouton_jaune").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-circle carte_jaune"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-circle carte_jaune"></i></div>')}),$("#bouton_bleu").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-circle carte_bleu"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-circle carte_bleu"></i></div>')}),$("#bouton_musique").click(function(){1==l?($(".carte_vide").replaceWith('<div class="carte"><i class="fa fa-music carte_musique"></i></div>'),l=0):0==e()&&$("#bloc_carte").append('<div class="carte"><i class="fa fa-music carte_musique"></i></div>')}),$("#bloc_carte").on("click",".carte",function(){$(".carte").index(this)==$(".carte").length-1&&$(this).prev().remove(),$(this).hasClass("carte_vide")&&(l=0),$(this).next().remove(),$(this).remove()}),$("#bloc_carte").on("click",".bouton_plus",function(){0==l&&$(".carte").length<16&&($('<div class="carte carte_vide"></div><i class="fa fa-plus bouton_plus"></i>').insertAfter($(this)),l=1)}),$("#bouton_effacer").click(function(){$("#bloc_carte").html(""),l=0}),$("#bouton_go").click(function(){var e="",l=0,t=0;for(e+='<xml xmlns="http://www.w3.org/1999/xhtml">',e+='<block type="0_1b_Evénement_QuandLeProgrammeCommence">',$("#bloc_carte i").each(function(){$(this).hasClass("carte_avancer")&&(e+='<next><block type="0_1b_Mouvement_Avance_SELVitesse_SAIDistance"><field name="Vitesse">NORMALEMENT</field><field name="Distance">'+$("#champ_pas").val()+'</field><next><block type="0_2_Sons_JoueUneNoteCroche_SELNote"><field name="Note">DO3</field>',l++,l++),$(this).hasClass("carte_reculer")&&(e+='<next><block type="0_1b_Mouvement_Recule_SELVitesse_SAIDistance"><field name="Vitesse">NORMALEMENT</field><field name="Distance">'+$("#champ_pas").val()+'</field><next><block type="0_2_Sons_JoueUneNoteCroche_SELNote"><field name="Note">DO3</field>',l++,l++),$(this).hasClass("carte_droite")&&(e+='<next><block type="0_1b_Mouvement_TourneADroite_SAIAngle"><field name="Angle">'+$("#champ_rotation").val()+'</field><next><block type="0_2_Sons_JoueUneNoteCroche_SELNote"><field name="Note">DO3</field>',l++,l++),$(this).hasClass("carte_gauche")&&(e+='<next><block type="0_1b_Mouvement_TourneAGauche_SAIAngle"><field name="Angle">'+$("#champ_rotation").val()+'</field><next><block type="0_2_Sons_JoueUneNoteCroche_SELNote"><field name="Note">DO3</field>',l++,l++),$(this).hasClass("carte_rouge")&&(e+='<next><block type="0_2_Lumières_AllumeLesLEDs_SELLED_SELCouleur_SAIDurée"><field name="LED">TOUTES_LES_LEDS</field><field name="Couleur">#ff0000</field><field name="Durée">'+$("#champ_lumiere").val()+"</field>",l++),$(this).hasClass("carte_jaune")&&(e+='<next><block type="0_2_Lumières_AllumeLesLEDs_SELLED_SELCouleur_SAIDurée"><field name="LED">TOUTES_LES_LEDS</field><field name="Couleur">#ffff00</field><field name="Durée">'+$("#champ_lumiere").val()+"</field>",l++),$(this).hasClass("carte_bleu")&&(e+='<next><block type="0_2_Lumières_AllumeLesLEDs_SELLED_SELCouleur_SAIDurée"><field name="LED">TOUTES_LES_LEDS</field><field name="Couleur">#000099</field><field name="Durée">'+$("#champ_lumiere").val()+"</field>",l++),$(this).hasClass("carte_musique")&&(e+='<next><block type="0_1b_Sons_JoueLaNote_SOL_Pendant05Seconde"><next><block type="0_1b_Sons_JoueLaNote_SOL_Pendant05Seconde"><next><block type="0_1b_Sons_JoueLaNote_SOL_Pendant05Seconde"><next><block type="0_1b_Sons_JoueLaNote_LA_Pendant05Seconde"><next><block type="0_1b_Sons_JoueLaNote_SOL_Pendant05Seconde"><next><block type="0_1b_Sons_JoueLaNote_RE_Pendant05Seconde">',t++)}),e+="</block>",i=0;i<l;i++)e+="</next></block>";for(i=0;i<6*t;i++)e+="</next></block>";e+="</xml>";var o=a(),c=new Blob([e],{type:"application/octet-stream"}),r=document.getElementById("lien_telechargement");r.download=o+".b4t",r.href=URL.createObjectURL(c),r.click()}),$("#bouton_parametrage").click(function(){$("#bloc_bouton_haut").hide(),$("#chevalet").hide(),$("#bloc_bouton_bas").hide(),$("#bouton_effacer").hide(),$("#bouton_go").hide(),$("#bouton_parametrage").hide(),$("#bloc_parametrage").show()}),$("#bouton_fermer_parametrage").click(function(){localStorage.valeur_pas=$("#champ_pas").val(),localStorage.valeur_rotation=$("#champ_rotation").val(),localStorage.valeur_lumiere=$("#champ_lumiere").val(),$("#bloc_bouton_haut").show(),$("#chevalet").show(),$("#bloc_bouton_bas").show(),$("#bouton_effacer").show(),$("#bouton_go").show(),$("#bouton_parametrage").show(),$("#bloc_parametrage").hide()}),$("#champ_langue").change(function(){var e=$(this).find("option:selected");"Français"==e.text()?($("#bloc_valeur label").eq(0).html("Langue"),$("#bloc_valeur label").eq(1).html("Avancer / Reculer"),$("#bloc_valeur label").eq(2).html("Rotation droite / gauche"),$("#bloc_valeur label").eq(3).html("Allumage lumières"),$("#bloc_valeur label").eq(4).html("Contact"),$("#bloc_valeur label").eq(5).html("Remerciements"),$("#bloc_valeur label").eq(6).html("Utilisation"),$("#champ_rotation").next().html("degrés"),$("#champ_lumiere").next().html("secondes"),$("#bloc_valeur li").eq(0).html('<a href="https://aseba.wdfiles.com/local--files/en:wininstall/aseba-bin-1.5.3-git-3567730-win32.exe" target="_blank">installez les pilotes de Thymio</a>'),$("#bloc_valeur li").eq(1).html('<a href="http://blockly4thymio.net//files/telechargements/installation-Blockly4Thymio.v1.0.exe" target="_blank">installez le compilateur Blockly4Thymio</a>'),$("#bloc_valeur li").eq(2).html("programmez les actions du robot et cliquez sur le bouton vert Valider"),$("#bloc_valeur li").eq(3).html("ouvrez le fichier .b4t généré avec le compilateur Blockly4Thymio"),$("#bloc_valeur li").eq(4).html("les instructions sont envoyées au robot qui devrait réagir instantanément"),$("#bloc_valeur li").eq(5).html('<a href="http://blockly4thymio.net//index.php/essayer.html" target="_blank">pour plus d\'informations, allez sur Blockly4Thymio.net</a>')):($("#bloc_valeur label").eq(0).html("Language"),$("#bloc_valeur label").eq(1).html("Forward / Backward"),$("#bloc_valeur label").eq(2).html("Right / Left rotation"),$("#bloc_valeur label").eq(3).html("Lights duration"),$("#bloc_valeur label").eq(4).html("Assistance"),$("#bloc_valeur label").eq(5).html("Thanks"),$("#bloc_valeur label").eq(6).html("How to use"),$("#champ_rotation").next().html("degrees"),$("#champ_lumiere").next().html("seconds"),$("#bloc_valeur li").eq(0).html('<a href="https://aseba.wdfiles.com/local--files/en:wininstall/aseba-bin-1.5.3-git-3567730-win32.exe" target="_blank">install Thymio drivers</a>'),$("#bloc_valeur li").eq(1).html('<a href="http://blockly4thymio.net//files/telechargements/installation-Blockly4Thymio.v1.0.exe" target="_blank">install Blockly4Thymio compiler</a>'),$("#bloc_valeur li").eq(2).html("program the robot instructions and click the green Check button"),$("#bloc_valeur li").eq(3).html("open the output .b4t file with Blockly4Thymio compiler"),$("#bloc_valeur li").eq(4).html("the instructions are sent to the robot which should go into action instantly"),$("#bloc_valeur li").eq(5).html('<a href="http://blockly4thymio.net//index.php/essayer.html" target="_blank">for more information, please refer to Blockly4Thymio.net</a>'))}),$("#champ_pas").change(function(){localStorage.valeur_pas=$(this).val()}),$("#champ_rotation").change(function(){localStorage.valeur_rotation=$(this).val()}),$("#champ_lumiere").change(function(){localStorage.valeur_lumiere=$(this).val()})});